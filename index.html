<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Evalify - OMR Evaluation System</title>
    <script src="https://cdn.tailwindcss.com"></script>
  <script type="importmap">
{
  "imports": {
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "react-router-dom": "https://aistudiocdn.com/react-router-dom@^7.9.1",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.20.0",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.544.0",
    "recharts": "https://aistudiocdn.com/recharts@^3.2.1"
  }
}
</script>
</head>
  <body class="bg-slate-50 text-slate-900">
    <div id="root"></div>
    <script type="module">
// This single script block now contains all the application logic.
// Library Imports
import React, { useState, useCallback, useMemo, createContext, useContext, useRef, useEffect, ChangeEvent, FormEvent } from 'react';
import ReactDOM from 'react-dom/client';
import { HashRouter, Routes, Route, Navigate, NavLink, useNavigate, Link } from 'react-router-dom';
import { GoogleGenAI, Type } from "@google/genai";
import { 
    BarChart as LucideBarChart, CheckSquare, Clipboard, PieChart as LucidePieChart, HelpCircle, GitBranch, Bell, 
    AtSign, KeyRound, ClipboardCheck, Facebook, Linkedin, CheckCircle, User as UserIcon, Upload, XCircle, 
    Loader, FileText, Key, FileSignature, PlusCircle, Pencil, Image as ImageIcon, FileCheck2, Star, Percent, 
    Hourglass, Download, BarChart3, AlertTriangle, Globe, LogOut, ChevronDown, Info, Settings, Phone, Lock, 
    Camera, Save, Check 
} from 'lucide-react';
import { 
    BarChart as RechartsBarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, 
    PieChart as RechartsPieChart, Pie, Cell, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, 
    Radar, LineChart, Line 
} from 'recharts';

// --- From types.ts ---
type AnswerOption = 'A' | 'B' | 'C' | 'D' | 'E' | '';

interface AnswerKey {
  [key: number]: AnswerOption;
}

interface DetectedAnswers {
  [key: number]: AnswerOption;
}

interface SubjectScores {
  [key: string]: {
    score: number;
    total: number;
  };
}

interface OMRResult {
  id: string;
  evaluationName?: string;
  imageFileName: string;
  evaluationDate: string;
  totalScore: number;
  subjectScores: SubjectScores;
  detectedAnswers: DetectedAnswers;
  answerKeyId: string;
}

interface User {
  email: string;
  name?: string;
  profilePicture?: string;
  phone?: string;
}

interface Notification {
  id: string;
  type: 'success' | 'info';
  message: string;
  timestamp: string;
  read: boolean;
}

// --- From constants.ts ---
const SUBJECTS = {
  'Subject 1': { start: 1, end: 20 },
  'Subject 2': { start: 21, end: 40 },
  'Subject 3': { start: 41, end: 60 },
  'Subject 4': { start: 61, end: 80 },
  'Subject 5': { start: 81, end: 100 },
};

const ANSWER_KEYS = {
  'Version A': {
    1: 'A', 2: 'B', 3: 'C', 4: 'D', 5: 'A', 6: 'B', 7: 'C', 8: 'D', 9: 'A', 10: 'B',
    11: 'C', 12: 'D', 13: 'A', 14: 'B', 15: 'C', 16: 'D', 17: 'A', 18: 'B', 19: 'C', 20: 'D',
    21: 'B', 22: 'C', 23: 'D', 24: 'A', 25: 'B', 26: 'C', 27: 'D', 28: 'A', 29: 'B', 30: 'C',
    31: 'D', 32: 'A', 33: 'B', 34: 'C', 35: 'D', 36: 'A', 37: 'B', 38: 'C', 39: 'D', 40: 'A',
    41: 'C', 42: 'D', 43: 'A', 44: 'B', 45: 'C', 46: 'D', 47: 'A', 48: 'B', 49: 'C', 50: 'D',
    51: 'A', 52: 'B', 53: 'C', 54: 'D', 55: 'A', 56: 'B', 57: 'C', 58: 'D', 59: 'A', 60: 'B',
    61: 'D', 62: 'A', 63: 'B', 64: 'C', 65: 'D', 66: 'A', 67: 'B', 68: 'C', 69: 'D', 70: 'A',
    71: 'B', 72: 'C', 73: 'D', 74: 'A', 75: 'B', 76: 'C', 77: 'D', 78: 'A', 79: 'B', 80: 'C',
    81: 'A', 82: 'B', 83: 'C', 84: 'D', 85: 'A', 86: 'B', 87: 'C', 88: 'D', 89: 'A', 90: 'B',
    91: 'C', 92: 'D', 93: 'A', 94: 'B', 95: 'C', 96: 'D', 97: 'A', 98: 'B', 99: 'C', 100: 'D',
  },
  'Version B': {
    1: 'D', 2: 'C', 3: 'B', 4: 'A', 5: 'D', 6: 'C', 7: 'B', 8: 'A', 9: 'D', 10: 'C',
    11: 'B', 12: 'A', 13: 'D', 14: 'C', 15: 'B', 16: 'A', 17: 'D', 18: 'C', 19: 'B', 20: 'A',
    21: 'A', 22: 'D', 23: 'C', 24: 'B', 25: 'A', 26: 'D', 27: 'C', 28: 'B', 29: 'A', 30: 'D',
    31: 'C', 32: 'B', 33: 'A', 34: 'D', 35: 'C', 36: 'B', 37: 'A', 38: 'D', 39: 'C', 40: 'B',
    41: 'B', 42: 'A', 43: 'D', 44: 'C', 45: 'B', 46: 'A', 47: 'D', 48: 'C', 49: 'B', 50: 'A',
    51: 'D', 52: 'C', 53: 'B', 54: 'A', 55: 'D', 56: 'C', 57: 'B', 58: 'A', 59: 'D', 60: 'C',
    61: 'C', 62: 'B', 63: 'A', 64: 'D', 65: 'C', 66: 'B', 67: 'A', 68: 'D', 69: 'C', 70: 'B',
    71: 'A', 72: 'D', 73: 'C', 74: 'B', 75: 'A', 76: 'D', 77: 'C', 78: 'B', 79: 'A', 80: 'D',
    81: 'D', 82: 'A', 83: 'B', 84: 'C', 85: 'D', 86: 'A', 87: 'B', 88: 'C', 89: 'D', 90: 'A',
    91: 'B', 92: 'C', 93: 'D', 94: 'A', 95: 'B', 96: 'C', 97: 'D', 98: 'A', 99: 'B', 100: 'C',
  },
};

// --- From contexts/AuthContext.ts ---
const AuthContext = createContext({
  user: null,
  login: (userData) => {},
  logout: () => {},
  updateUser: (updatedData) => {},
});

// --- From services/geminiService.ts ---
const API_KEY = process.env.API_KEY;

if (!API_KEY) {
  console.error("API_KEY environment variable not set.");
}

const ai = new GoogleGenAI({ apiKey: API_KEY });

const fileToGenerativePart = async (file) => {
  const base64EncodedDataPromise = new Promise((resolve) => {
    const reader = new FileReader();
    reader.onloadend = () => resolve(reader.result.split(',')[1]);
    reader.readAsDataURL(file);
  });
  return {
    inlineData: { data: await base64EncodedDataPromise, mimeType: file.type },
  };
};

const evaluateOMRWithGemini = async (imageFile) => {
  const imagePart = await fileToGenerativePart(imageFile);

  const properties = {};
  for (let i = 1; i <= 100; i++) {
    properties[i.toString()] = {
      type: Type.STRING,
      description: `The marked answer for question ${i}. Should be 'A', 'B', 'C', 'D', or 'E'. If unmarked, return an empty string.`,
    };
  }

  const response = await ai.models.generateContent({
    model: "gemini-2.5-flash",
    contents: [
      {
        parts: [
          {
            text: `You are an expert OMR (Optical Mark Recognition) sheet evaluation system.
            Your task is to analyze the following image of an OMR sheet and determine which bubble is marked for each question.
            The sheet has 100 questions.
            For each question from 1 to 100, identify the marked option ('A', 'B', 'C', 'D', or 'E').
            If a question has no mark or multiple marks, consider it unanswered and return an empty string for it.
            Respond ONLY with a single, valid JSON object that strictly adheres to the provided schema. Do not include any text before or after the JSON object.`
          },
          imagePart
        ]
      }
    ],
    config: {
      responseMimeType: "application/json",
      responseSchema: {
        type: Type.OBJECT,
        properties: {
          answers: {
            type: Type.OBJECT,
            properties: properties,
          },
        },
        required: ['answers'],
      },
    },
  });

  const jsonText = response.text.trim();
  const result = JSON.parse(jsonText);
  return result.answers;
};

const calculateScores = (detectedAnswers, answerKey, imageFileName, answerKeyId, evaluationName) => {
  const subjectScores = {};
  let totalScore = 0;

  for (const subjectName in SUBJECTS) {
    const { start, end } = SUBJECTS[subjectName];
    let subjectCorrect = 0;
    for (let i = start; i <= end; i++) {
      if (detectedAnswers[i] && detectedAnswers[i] === answerKey[i]) {
        subjectCorrect++;
      }
    }
    subjectScores[subjectName] = { score: subjectCorrect, total: end - start + 1 };
    totalScore += subjectCorrect;
  }
  
  return {
    id: `res_${new Date().getTime()}`,
    evaluationName: evaluationName || '',
    imageFileName,
    evaluationDate: new Date().toISOString(),
    totalScore,
    subjectScores,
    detectedAnswers,
    answerKeyId,
  };
};

const saveResultToLocalStorage = (result) => {
    const results = getResultsFromLocalStorage();
    results.unshift(result);
    localStorage.setItem('evalify_results', JSON.stringify(results));
};

const getResultsFromLocalStorage = () => {
    const resultsJson = localStorage.getItem('evalify_results');
    try {
      return resultsJson ? JSON.parse(resultsJson) : [];
    } catch (e) {
      return [];
    }
};

const CUSTOM_ANSWER_KEYS_KEY = 'evalify_custom_answer_keys';

const getCustomAnswerKeys = () => {
    const keysJson = localStorage.getItem(CUSTOM_ANSWER_KEYS_KEY);
    try {
        return keysJson ? JSON.parse(keysJson) : {};
    } catch (e) {
        return {};
    }
};

const saveCustomAnswerKey = (name, key) => {
    if (!name.trim()) {
        throw new Error("Answer key name cannot be empty.");
    }
    const customKeys = getCustomAnswerKeys();
    if (Object.keys(ANSWER_KEYS).includes(name)) {
        throw new Error(`Cannot overwrite default answer key: ${name}`);
    }
    customKeys[name] = key;
    localStorage.setItem(CUSTOM_ANSWER_KEYS_KEY, JSON.stringify(customKeys));
};

const getAllAnswerKeys = () => {
    const customKeys = getCustomAnswerKeys();
    return { ...ANSWER_KEYS, ...customKeys };
};

const NOTIFICATION_KEY = 'evalify_notifications';

const getNotifications = () => {
    const notificationsJson = localStorage.getItem(NOTIFICATION_KEY);
    try {
        const notifications = notificationsJson ? JSON.parse(notificationsJson) : [];
        return notifications.sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());
    } catch (e) {
        return [];
    }
};

const addNotification = (notificationData) => {
    const notifications = getNotifications();
    const newNotification = {
        id: `notif_${new Date().getTime()}`,
        timestamp: new Date().toISOString(),
        read: false,
        ...notificationData,
    };
    notifications.unshift(newNotification);
    const trimmedNotifications = notifications.slice(0, 20);
    localStorage.setItem(NOTIFICATION_KEY, JSON.stringify(trimmedNotifications));
    window.dispatchEvent(new Event('notifications-updated'));
};

const markAllNotificationsAsRead = () => {
    const notifications = getNotifications();
    const updatedNotifications = notifications.map(n => ({ ...n, read: true }));
    localStorage.setItem(NOTIFICATION_KEY, JSON.stringify(updatedNotifications));
    window.dispatchEvent(new Event('notifications-updated'));
};

const hasUnreadNotifications = () => {
    return getNotifications().some(n => !n.read);
};

// --- From components/Sidebar.tsx ---
const Sidebar = () => {
    const navItems = [
        { name: 'OMR Verifier', path: '/', icon: CheckSquare },
        { name: 'Dashboard', path: '/dashboard', icon: LucideBarChart },
        { name: 'Results', path: '/results', icon: Clipboard },
        { name: 'Analytics', path: '/analytics', icon: LucidePieChart },
        { name: 'Notifications', path: '/notifications', icon: Bell },
        { name: 'Help & FAQ', path: '/help', icon: HelpCircle },
    ];
    
    return (
        React.createElement('div', { className: "w-64 bg-white shadow-lg flex flex-col flex-shrink-0" },
            React.createElement('div', { className: "flex items-center justify-center h-20 border-b border-slate-200" },
                 React.createElement(GitBranch, { className: "h-8 w-8 text-indigo-600" }),
                React.createElement('h1', { className: "text-2xl font-bold text-indigo-600 ml-2" }, "Evalify")
            ),
            React.createElement('nav', { className: "flex-1 px-4 py-6 space-y-2" },
                navItems.map((item) => (
                    React.createElement(NavLink, {
                        key: item.name,
                        to: item.path,
                        end: item.path === '/',
                        className: ({ isActive }) =>
                            `flex items-center px-4 py-3 text-slate-700 rounded-lg transition-colors duration-200 hover:bg-indigo-50 hover:text-indigo-600 ${
                                isActive ? 'bg-indigo-100 text-indigo-600 font-semibold' : ''
                            }`
                        },
                        React.createElement(item.icon, { className: "h-5 w-5 mr-3" }),
                        React.createElement('span', null, item.name)
                    )
                ))
            )
        )
    );
};

// --- From components/Header.tsx ---
const Header = () => {
    const { user, logout } = useContext(AuthContext);
    const navigate = useNavigate();
    const [notificationsOpen, setNotificationsOpen] = useState(false);
    const [languageOpen, setLanguageOpen] = useState(false);
    const [profileOpen, setProfileOpen] = useState(false);
    const [notifications, setNotifications] = useState([]);
    const [hasUnread, setHasUnread] = useState(false);

    const languages = ['English (US)', 'Español', 'Français'];
    const [selectedLanguage, setSelectedLanguage] = useState(languages[0]);

    const notificationsRef = useRef(null);
    const languageRef = useRef(null);
    const profileRef = useRef(null);

    const handleLogout = () => {
        logout();
        navigate('/login');
    };

    const timeSince = (dateString) => {
        const date = new Date(dateString);
        const seconds = Math.floor((new Date().getTime() - date.getTime()) / 1000);
        let interval = seconds / 31536000;
        if (interval > 1) return `${Math.floor(interval)} years ago`;
        interval = seconds / 2592000;
        if (interval > 1) return `${Math.floor(interval)} months ago`;
        interval = seconds / 86400;
        if (interval > 1) return `${Math.floor(interval)} days ago`;
        interval = seconds / 3600;
        if (interval > 1) return `${Math.floor(interval)} hours ago`;
        interval = seconds / 60;
        if (interval > 1) return `${Math.floor(interval)} minutes ago`;
        return `${Math.floor(seconds)} seconds ago`;
    };
    
    const updateUnreadStatus = () => {
        setHasUnread(hasUnreadNotifications());
    };

    useEffect(() => {
        updateUnreadStatus();
        window.addEventListener('notifications-updated', updateUnreadStatus);
        return () => {
            window.removeEventListener('notifications-updated', updateUnreadStatus);
        };
    }, []);

    useEffect(() => {
        const handleClickOutside = (event) => {
            if (notificationsRef.current && !notificationsRef.current.contains(event.target)) {
                setNotificationsOpen(false);
            }
            if (languageRef.current && !languageRef.current.contains(event.target)) {
                setLanguageOpen(false);
            }
            if (profileRef.current && !profileRef.current.contains(event.target)) {
                setProfileOpen(false);
            }
        };
        document.addEventListener("mousedown", handleClickOutside);
        return () => document.removeEventListener("mousedown", handleClickOutside);
    }, []);

    const handleNotificationToggle = () => {
        if (!notificationsOpen) {
            setNotifications(getNotifications().slice(0, 5));
        }
        setNotificationsOpen(!notificationsOpen);
    };


    return (
        React.createElement('header', { className: "bg-white shadow-sm h-20 flex-shrink-0" },
            React.createElement('div', { className: "flex items-center justify-end px-4 sm:px-6 lg:px-8 h-full" },
                React.createElement('div', { className: "flex items-center space-x-5" },
                    React.createElement('div', { className: "relative", ref: languageRef },
                        React.createElement('button', { onClick: () => setLanguageOpen(!languageOpen), className: "flex items-center text-slate-600 hover:text-indigo-600 focus:outline-none text-sm", "aria-label": "Select language" },
                            React.createElement(Globe, { className: "h-5 w-5" }),
                             React.createElement('span', { className: "hidden md:block ml-2" }, selectedLanguage),
                             React.createElement(ChevronDown, { className: "h-4 w-4 ml-1 text-slate-500" })
                        ),
                        languageOpen && (
                            React.createElement('div', { className: "absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg py-1 z-20" },
                                languages.map(lang => (
                                    React.createElement('button', {
                                        key: lang,
                                        onClick: () => {
                                            setSelectedLanguage(lang);
                                            setLanguageOpen(false);
                                        },
                                        className: `w-full text-left block px-4 py-2 text-sm text-slate-700 hover:bg-indigo-50 ${selectedLanguage === lang ? 'bg-indigo-50 font-semibold' : ''}`
                                    },
                                        lang
                                    )
                                ))
                            )
                        )
                    ),
                    React.createElement('div', { className: "relative", ref: notificationsRef },
                        React.createElement('button', { onClick: handleNotificationToggle, className: "flex items-center text-slate-600 hover:text-indigo-600 focus:outline-none", "aria-label": "View notifications" },
                            React.createElement(Bell, { className: "h-6 w-6" }),
                            hasUnread && React.createElement('span', { className: "absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white" })
                        ),
                        notificationsOpen && (
                            React.createElement('div', { className: "absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg z-20" },
                                React.createElement('div', { className: "p-3 font-semibold text-slate-800 border-b" }, "Notifications"),
                                React.createElement('div', { className: "py-1 max-h-80 overflow-y-auto" },
                                    notifications.length > 0 ? (
                                        notifications.map(notification => (
                                            React.createElement('div', { key: notification.id, className: "flex items-start px-4 py-3 text-sm text-slate-700 hover:bg-indigo-50" },
                                                React.createElement('div', { className: `p-2 rounded-full mr-3 mt-1 ${notification.type === 'success' ? 'bg-green-100' : 'bg-blue-100'}` },
                                                    notification.type === 'success' ? (
                                                        React.createElement(CheckCircle, { className: "h-4 w-4 text-green-600" })
                                                    ) : (
                                                        React.createElement(Info, { className: "h-4 w-4 text-blue-600" })
                                                    )
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('p', { className: "font-medium" }, notification.message),
                                                    React.createElement('p', { className: "text-xs text-slate-500" }, timeSince(notification.timestamp))
                                                )
                                            )
                                        ))
                                    ) : (
                                       React.createElement('p', { className: "text-center text-sm text-slate-500 py-4" }, "No new notifications.")
                                    )
                                ),
                                React.createElement('div', { className: "p-2 text-center border-t" },
                                    React.createElement(Link, { to: "/notifications", onClick: () => setNotificationsOpen(false), className: "text-sm text-indigo-600 hover:underline" }, "View all notifications")
                                )
                            )
                        )
                    ),
                    React.createElement('div', { className: "h-8 w-px bg-slate-200" }),
                    React.createElement('div', { className: "relative", ref: profileRef },
                        React.createElement('button', { onClick: () => setProfileOpen(!profileOpen), className: "flex items-center space-x-3 focus:outline-none", "aria-label": "Open user menu" },
                             user?.profilePicture ? (
                                React.createElement('img', { src: user.profilePicture, alt: "Profile", className: "h-10 w-10 rounded-full object-cover" })
                             ) : (
                                React.createElement('div', { className: "p-2 bg-indigo-100 rounded-full" },
                                    React.createElement(UserIcon, { className: "h-6 w-6 text-indigo-600" })
                                )
                             ),
                            React.createElement('div', { className: "text-left hidden md:block" },
                                React.createElement('p', { className: "text-sm font-medium text-slate-800 truncate" }, user?.name || 'Evaluator'),
                                React.createElement('p', { className: "text-xs text-slate-500 truncate" }, user?.email)
                            ),
                            React.createElement(ChevronDown, { className: "h-4 w-4 text-slate-500" })
                        ),
                        profileOpen && (
                            React.createElement('div', { className: "absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-1 z-20" },
                                React.createElement('button', {
                                    onClick: () => { navigate('/profile'); setProfileOpen(false); },
                                    className: "w-full text-left flex items-center px-4 py-2 text-sm text-slate-700 hover:bg-indigo-50"
                                },
                                    React.createElement(Settings, { className: "h-4 w-4 mr-2" }),
                                    "Profile Settings"
                                ),
                                React.createElement('button', {
                                    onClick: handleLogout,
                                    className: "w-full text-left flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50"
                                },
                                    React.createElement(LogOut, { className: "h-4 w-4 mr-2" }),
                                    "Logout"
                                )
                            )
                        )
                    )
                )
            )
        )
    );
};

// --- From components/MainLayout.tsx ---
const MainLayout = ({ children }) => {
  return (
    React.createElement('div', { className: "flex h-screen bg-transparent" },
      React.createElement(Sidebar, null),
      React.createElement('div', { className: "flex-1 flex flex-col overflow-hidden" },
        React.createElement(Header, null),
        React.createElement('main', { className: "flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto bg-gradient-to-br from-indigo-50 via-white to-blue-50" },
          children
        )
      )
    )
  );
};

// --- From pages/LoginPage.tsx ---
const GoogleIcon = () => (
    React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 48 48", className: "w-5 h-5" },
      React.createElement('path', { fill: "#FFC107", d: "M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039L38.802 9.92C34.553 6.184 29.654 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z" }),
      React.createElement('path', { fill: "#FF3D00", d: "M6.306 14.691c-1.219 2.44-1.936 5.18-1.936 8.179c0 3.001.717 5.74 1.936 8.179l-5.022 3.91c-2.203-4.32-3.414-9.39-3.414-14.829c0-5.438 1.211-10.509 3.414-14.829L6.306 14.691z" }),
      React.createElement('path', { fill: "#4CAF50", d: "M24 48c5.655 0 10.742-1.823 14.829-4.89l-5.022-3.91c-2.44 1.218-5.179 1.935-8.179 1.935c-5.18 0-9.62-3.343-11.303-7.962L2.613 36.87C6.864 43.816 14.792 48 24 48z" }),
      React.createElement('path', { fill: "#1976D2", d: "M43.611 20.083L43.595 20L42 20H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.574l5.022 3.91c4.32-2.202 7.82-6.522 9.25-11.774c.251-1.26.389-2.577.389-3.917z" })
    )
  );

const LoginPage = () => {
  const [email, setEmail] = useState('evaluator@innomatics.com');
  const [password, setPassword] = useState('password123');
  const [error, setError] = useState('');
  const { login } = useContext(AuthContext);
  
  const [isForgotPasswordOpen, setIsForgotPasswordOpen] = useState(false);
  const [resetEmail, setResetEmail] = useState('');
  const [isEmailSent, setIsEmailSent] = useState(false);
  
  const [isRegisterOpen, setIsRegisterOpen] = useState(false);
  const [isRegistrationComplete, setIsRegistrationComplete] = useState(false);
  const [registerData, setRegisterData] = useState({
      name: '',
      email: '',
      password: '',
      confirmPassword: '',
  });
  const [registerError, setRegisterError] = useState('');


  const handleSubmit = (e) => {
    e.preventDefault();
    if (email === 'evaluator@innomatics.com' && password === 'password123') {
      login({ email });
    } else {
      setError('Invalid credentials. Please use the default values.');
    }
  };

  const handlePasswordReset = (e) => {
      e.preventDefault();
      if(resetEmail) {
          setIsEmailSent(true);
      }
  }

  const closeForgotPasswordModal = () => {
      setIsForgotPasswordOpen(false);
      setTimeout(() => {
          setResetEmail('');
          setIsEmailSent(false);
      }, 300);
  }

  const handleRegisterChange = (e) => {
      setRegisterData({ ...registerData, [e.target.name]: e.target.value });
      if (registerError) setRegisterError('');
  };

  const handleRegisterSubmit = (e) => {
      e.preventDefault();
      setRegisterError('');
      if (registerData.password !== registerData.confirmPassword) {
          setRegisterError("Passwords do not match.");
          return;
      }
      setIsRegistrationComplete(true);
  };

  const closeRegisterModal = () => {
      setIsRegisterOpen(false);
      setTimeout(() => {
          setIsRegistrationComplete(false);
          setRegisterData({ name: '', email: '', password: '', confirmPassword: '' });
          setRegisterError('');
      }, 300);
  };

  return (
    React.createElement(React.Fragment, null,
      React.createElement('div', { className: "min-h-screen bg-slate-100 flex items-center justify-center p-4" },
        React.createElement('div', { className: "flex w-full max-w-5xl bg-white rounded-xl shadow-2xl overflow-hidden" },
          React.createElement('div', { className: "hidden md:flex flex-col justify-center items-center w-1/2 bg-indigo-600 p-12 text-white text-center" },
              React.createElement('h1', { className: "text-4xl font-bold leading-tight mb-4" }, "Automated OMR Evaluation & Scoring System"),
              React.createElement('p', { className: "text-indigo-100 mb-8" },
                  "Streamline your examination process with our advanced OMR evaluation technology. Get accurate results instantly."
              ),
              React.createElement(ClipboardCheck, { className: "w-40 h-40 text-indigo-300 mb-8" }),
              React.createElement('p', { className: "font-semibold" }, "Login to access the powerful evaluation tools")
          ),
          React.createElement('div', { className: "w-full md:w-1/2 p-8 sm:p-12" },
              React.createElement('div', { className: "w-full max-w-md mx-auto" },
                  React.createElement('h1', { className: "text-3xl font-bold text-indigo-600" }, "EVALIFY"),
                  React.createElement('p', { className: "text-slate-500 mb-8" }, "Automated OMR Evaluation System"),
                  React.createElement('form', { className: "space-y-4", onSubmit: handleSubmit },
                       React.createElement('div', null,
                          React.createElement('label', { htmlFor: "email-address", className: "text-sm font-semibold text-slate-700" }, "Username"),
                          React.createElement('div', { className: "relative mt-1" },
                              React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                  React.createElement(AtSign, { className: "h-5 w-5 text-slate-400" })
                              ),
                              React.createElement('input', {
                                  id: "email-address",
                                  name: "email",
                                  type: "email",
                                  autoComplete: "email",
                                  required: true,
                                  className: "block w-full px-3 py-2.5 pl-10 border border-slate-300 rounded-md placeholder-slate-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",
                                  placeholder: "Enter your username",
                                  value: email,
                                  onChange: (e) => setEmail(e.target.value)
                              })
                          )
                      ),
                       React.createElement('div', null,
                          React.createElement('label', { htmlFor: "password", className: "text-sm font-semibold text-slate-700" }, "Password"),
                           React.createElement('div', { className: "relative mt-1" },
                              React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                  React.createElement(KeyRound, { className: "h-5 w-5 text-slate-400" })
                              ),
                              React.createElement('input', {
                                  id: "password",
                                  name: "password",
                                  type: "password",
                                  autoComplete: "current-password",
                                  required: true,
                                  className: "block w-full px-3 py-2.5 pl-10 border border-slate-300 rounded-md placeholder-slate-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",
                                  placeholder: "Enter your password",
                                  value: password,
                                  onChange: (e) => setPassword(e.target.value)
                              })
                          )
                      ),
                      React.createElement('div', { className: "flex items-center justify-between text-sm" },
                          React.createElement('div', { className: "flex items-center" },
                              React.createElement('input', { id: "remember-me", name: "remember-me", type: "checkbox", className: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-slate-300 rounded" }),
                              React.createElement('label', { htmlFor: "remember-me", className: "ml-2 block text-slate-900" }, "Remember me")
                          ),
                          React.createElement('button', { type: "button", onClick: () => setIsForgotPasswordOpen(true), className: "font-medium text-indigo-600 hover:text-indigo-500" }, "Forgot Password?")
                      ),
                      error && React.createElement('p', { className: "text-sm text-red-600" }, error),
                      React.createElement('div', null,
                          React.createElement('button', {
                          type: "submit",
                          className: "w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out"
                          },
                          "Login"
                          )
                      )
                  ),
                  React.createElement('div', { className: "relative my-6" },
                      React.createElement('div', { className: "absolute inset-0 flex items-center", "aria-hidden": "true" },
                          React.createElement('div', { className: "w-full border-t border-slate-300" })
                      ),
                      React.createElement('div', { className: "relative flex justify-center text-sm" },
                          React.createElement('span', { className: "px-2 bg-white text-slate-500" }, "Or login with")
                      )
                  ),
                  React.createElement('div', { className: "flex justify-center space-x-4" },
                      React.createElement('a', { href: "https://facebook.com", target: "_blank", rel: "noopener noreferrer", "aria-label": "Login with Facebook", className: "w-10 h-10 flex items-center justify-center rounded-full border border-slate-300 text-[#1877F2] hover:bg-slate-50" },
                          React.createElement(Facebook, { className: "w-5 h-5" })
                      ),
                      React.createElement('a', { href: "https://google.com", target: "_blank", rel: "noopener noreferrer", "aria-label": "Login with Google", className: "w-10 h-10 flex items-center justify-center rounded-full border border-slate-300 hover:bg-slate-50" },
                         React.createElement(GoogleIcon, null)
                      ),
                      React.createElement('a', { href: "https://linkedin.com", target: "_blank", rel: "noopener noreferrer", "aria-label": "Login with LinkedIn", className: "w-10 h-10 flex items-center justify-center rounded-full border border-slate-300 text-[#0A66C2] hover:bg-slate-50" },
                          React.createElement(Linkedin, { className: "w-5 h-5" })
                      )
                  ),
                  React.createElement('p', { className: "text-center text-sm text-slate-500 mt-8" },
                      "Don't have an account? ", React.createElement('button', { type: "button", onClick: () => setIsRegisterOpen(true), className: "font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none" }, "Register here")
                  )
              )
          )
        )
      ),
      isForgotPasswordOpen && (
        React.createElement('div', { 
            className: "fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 transition-opacity", 
            "aria-labelledby": "modal-title", role: "dialog", "aria-modal": "true"
        },
          React.createElement('div', { className: "bg-white rounded-xl shadow-2xl p-6 sm:p-8 w-full max-w-md m-4 transform transition-all" },
            React.createElement('div', { className: "text-center" },
              !isEmailSent ? (
                React.createElement(React.Fragment, null,
                  React.createElement('div', { className: "mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-indigo-100" },
                    React.createElement(KeyRound, { className: "h-6 w-6 text-indigo-600" })
                  ),
                  React.createElement('h3', { className: "mt-4 text-2xl font-bold text-slate-800", id: "modal-title" }, "Forgot Password?"),
                  React.createElement('p', { className: "mt-2 text-slate-500" }, "No problem. Enter your email below and we'll send you a link to reset it."),
                  React.createElement('form', { onSubmit: handlePasswordReset, className: "mt-6 text-left" },
                    React.createElement('div', null,
                      React.createElement('label', { htmlFor: "reset-email", className: "text-sm font-semibold text-slate-700" }, "Email Address"),
                      React.createElement('div', { className: "relative mt-1" },
                        React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                          React.createElement(AtSign, { className: "h-5 w-5 text-slate-400" })
                        ),
                        React.createElement('input', {
                          id: "reset-email",
                          name: "email",
                          type: "email",
                          autoComplete: "email",
                          required: true,
                          className: "block w-full px-3 py-2.5 pl-10 border border-slate-300 rounded-md placeholder-slate-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",
                          placeholder: "you@example.com",
                          value: resetEmail,
                          onChange: (e) => setResetEmail(e.target.value)
                        })
                      )
                    ),
                    React.createElement('div', { className: "mt-6 flex flex-col sm:flex-row-reverse gap-3" },
                      React.createElement('button', {
                        type: "submit",
                        className: "w-full sm:w-auto inline-flex justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
                      },
                        "Send Reset Link"
                      ),
                      React.createElement('button', {
                        type: "button",
                        onClick: closeForgotPasswordModal,
                        className: "w-full sm:w-auto inline-flex justify-center rounded-md border border-slate-300 bg-white px-4 py-2 text-base font-medium text-slate-700 shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
                      },
                        "Cancel"
                      )
                    )
                  )
                )
              ) : (
                React.createElement(React.Fragment, null,
                  React.createElement('div', { className: "mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100" },
                      React.createElement(CheckCircle, { className: "h-6 w-6 text-green-600" })
                  ),
                  React.createElement('h3', { className: "mt-4 text-2xl font-bold text-slate-800" }, "Check your inbox"),
                  React.createElement('div', { className: "mt-4 text-slate-600" },
                      React.createElement('p', null, "We've sent a password reset link to ", React.createElement('strong', null, resetEmail), "."),
                      React.createElement('p', { className: "mt-2 text-sm text-slate-500 italic" }, "(Please note: This is a demo. No email has actually been sent.)")
                  ),
                  React.createElement('div', { className: "mt-6" },
                      React.createElement('button', {
                          type: "button",
                          onClick: closeForgotPasswordModal,
                          className: "w-full inline-flex justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
                      },
                          "Close"
                      )
                  )
                )
              )
            )
          )
        )
      ),
      isRegisterOpen && (
        React.createElement('div', { 
            className: "fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 transition-opacity", 
            "aria-labelledby": "register-modal-title", role: "dialog", "aria-modal": "true"
        },
          React.createElement('div', { className: "bg-white rounded-xl shadow-2xl p-6 sm:p-8 w-full max-w-md m-4 transform transition-all" },
            React.createElement('div', { className: "text-center" },
              !isRegistrationComplete ? (
                React.createElement(React.Fragment, null,
                  React.createElement('div', { className: "mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-indigo-100" },
                    React.createElement(UserIcon, { className: "h-6 w-6 text-indigo-600" })
                  ),
                  React.createElement('h3', { className: "mt-4 text-2xl font-bold text-slate-800", id: "register-modal-title" }, "Create an Account"),
                  React.createElement('p', { className: "mt-2 text-slate-500" }, "Join Evalify to start evaluating OMR sheets today."),
                  React.createElement('form', { onSubmit: handleRegisterSubmit, className: "mt-6 text-left space-y-4" },
                    React.createElement('div', null,
                      React.createElement('label', { htmlFor: "register-name", className: "text-sm font-semibold text-slate-700" }, "Full Name"),
                      React.createElement('div', { className: "relative mt-1" },
                        React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                          React.createElement(UserIcon, { className: "h-5 w-5 text-slate-400" })
                        ),
                        React.createElement('input', {
                          id: "register-name", name: "name", type: "text", required: true,
                          className: "block w-full px-3 py-2.5 pl-10 border border-slate-300 rounded-md placeholder-slate-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",
                          placeholder: "John Doe",
                          value: registerData.name, onChange: handleRegisterChange
                        })
                      )
                    ),
                    React.createElement('div', null,
                      React.createElement('label', { htmlFor: "register-email", className: "text-sm font-semibold text-slate-700" }, "Email Address"),
                      React.createElement('div', { className: "relative mt-1" },
                        React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                          React.createElement(AtSign, { className: "h-5 w-5 text-slate-400" })
                        ),
                        React.createElement('input', {
                          id: "register-email", name: "email", type: "email", autoComplete: "email", required: true,
                          className: "block w-full px-3 py-2.5 pl-10 border border-slate-300 rounded-md placeholder-slate-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",
                          placeholder: "you@example.com",
                          value: registerData.email, onChange: handleRegisterChange
                        })
                      )
                    ),
                    React.createElement('div', null,
                      React.createElement('label', { htmlFor: "register-password", className: "text-sm font-semibold text-slate-700" }, "Password"),
                      React.createElement('div', { className: "relative mt-1" },
                        React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                          React.createElement(KeyRound, { className: "h-5 w-5 text-slate-400" })
                        ),
                        React.createElement('input', {
                          id: "register-password", name: "password", type: "password", required: true,
                          className: "block w-full px-3 py-2.5 pl-10 border border-slate-300 rounded-md placeholder-slate-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",
                          placeholder: "••••••••",
                          value: registerData.password, onChange: handleRegisterChange
                        })
                      )
                    ),
                    React.createElement('div', null,
                      React.createElement('label', { htmlFor: "register-confirm-password", className: "text-sm font-semibold text-slate-700" }, "Confirm Password"),
                      React.createElement('div', { className: "relative mt-1" },
                        React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                          React.createElement(KeyRound, { className: "h-5 w-5 text-slate-400" })
                        ),
                        React.createElement('input', {
                          id: "register-confirm-password", name: "confirmPassword", type: "password", required: true,
                          className: "block w-full px-3 py-2.5 pl-10 border border-slate-300 rounded-md placeholder-slate-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",
                          placeholder: "••••••••",
                          value: registerData.confirmPassword, onChange: handleRegisterChange
                        })
                      )
                    ),
                    registerError && React.createElement('p', { className: "text-sm text-red-600" }, registerError),
                    React.createElement('div', { className: "mt-6 flex flex-col sm:flex-row-reverse gap-3" },
                      React.createElement('button', { type: "submit", className: "w-full sm:w-auto inline-flex justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" },
                        "Create Account"
                      ),
                      React.createElement('button', { type: "button", onClick: closeRegisterModal, className: "w-full sm:w-auto inline-flex justify-center rounded-md border border-slate-300 bg-white px-4 py-2 text-base font-medium text-slate-700 shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" },
                        "Cancel"
                      )
                    )
                  )
                )
              ) : (
                React.createElement(React.Fragment, null,
                  React.createElement('div', { className: "mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100" },
                      React.createElement(CheckCircle, { className: "h-6 w-6 text-green-600" })
                  ),
                  React.createElement('h3', { className: "mt-4 text-2xl font-bold text-slate-800" }, "Registration Successful!"),
                  React.createElement('div', { className: "mt-4 text-slate-600" },
                      React.createElement('p', null, "Welcome, ", React.createElement('strong', null, registerData.name), "! Your account has been created."),
                      React.createElement('p', { className: "mt-2 text-sm text-slate-500 italic" }, "(Please note: This is a demo. No account has actually been created. You can log in with the default credentials.)")
                  ),
                  React.createElement('div', { className: "mt-6" },
                      React.createElement('button', {
                          type: "button",
                          onClick: closeRegisterModal,
                          className: "w-full inline-flex justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
                      },
                          "Close"
                      )
                  )
                )
              )
            )
          )
        )
      )
    )
  );
};


// --- From pages/VerifierPage.tsx ---
const ManualKeyEntry = ({ answers, setAnswers }) => {
    const handleAnswerChange = (qNum, value) => {
        const validValue = value.toUpperCase().match(/[A-E]/);
        setAnswers(prev => ({ ...prev, [qNum]: validValue ? validValue[0] : '' }));
    };

    return (
        React.createElement('div', { className: "space-y-4" },
            Object.entries(SUBJECTS).map(([subjectName, { start, end }]) => (
                React.createElement('div', { key: subjectName },
                    React.createElement('h4', { className: "font-semibold text-slate-600 mb-2" }, `${subjectName} (${start}-${end})`),
                    React.createElement('div', { className: "grid grid-cols-5 md:grid-cols-10 gap-x-2 gap-y-3" },
                        Array.from({ length: end - start + 1 }, (_, i) => start + i).map(qNum => (
                            React.createElement('div', { key: qNum, className: "flex items-center" },
                                React.createElement('label', { htmlFor: `q-${qNum}`, className: "text-xs text-slate-500 mr-1 w-6 text-right" }, qNum),
                                React.createElement('input', {
                                    id: `q-${qNum}`,
                                    type: "text",
                                    maxLength: 1,
                                    value: answers[qNum] || '',
                                    onChange: e => handleAnswerChange(qNum, e.target.value),
                                    className: "w-8 h-8 text-center border border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
                                })
                            )
                        ))
                    )
                )
            ))
        )
    );
};

const AnswerKeyModal = ({ onClose, onKeyAdded }) => {
    const [keyName, setKeyName] = useState('');
    const [method, setMethod] = useState('manual');
    const [manualAnswers, setManualAnswers] = useState({});
    const [keyImageFile, setKeyImageFile] = useState(null);
    const [keyImagePreview, setKeyImagePreview] = useState(null);
    const [isSaving, setIsSaving] = useState(false);
    const [modalError, setModalError] = useState('');

    const handleKeyFileChange = (e) => {
        const file = e.target.files?.[0];
        if (file) {
            setKeyImageFile(file);
            setModalError('');
            const reader = new FileReader();
            reader.onloadend = () => setKeyImagePreview(reader.result);
            reader.readAsDataURL(file);
        }
    };

    const handleSave = async () => {
        if (!keyName.trim()) {
            setModalError('Please provide a name for the answer key.');
            return;
        }
        setModalError('');
        setIsSaving(true);

        try {
            let newKey;
            if (method === 'manual') {
                const filledAnswers = Object.entries(manualAnswers)
                    .filter(([, value]) => value)
                    .reduce((obj, [key, value]) => ({...obj, [key]: value}), {});
                newKey = filledAnswers;
            } else {
                if (!keyImageFile) {
                    setModalError('Please upload an OMR sheet image for the key.');
                    setIsSaving(false);
                    return;
                }
                const detectedAnswers = await evaluateOMRWithGemini(keyImageFile);
                newKey = detectedAnswers;
            }
            saveCustomAnswerKey(keyName, newKey);
            onKeyAdded(keyName);
            onClose();
        } catch (err) {
            console.error(err);
            setModalError(err.message || 'Failed to save answer key. Please try again.');
        } finally {
            setIsSaving(false);
        }
    };
    
    return (
        React.createElement('div', { className: "fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60", "aria-modal": "true" },
            React.createElement('div', { className: "bg-white rounded-xl shadow-2xl w-full max-w-2xl m-4 transform transition-all max-h-[90vh] flex flex-col" },
                React.createElement('div', { className: "p-6 border-b" },
                    React.createElement('h2', { className: "text-2xl font-bold text-slate-800" }, "Create New Answer Key")
                ),
                React.createElement('div', { className: "p-6 space-y-6 overflow-y-auto" },
                    React.createElement('div', null,
                        React.createElement('label', { htmlFor: "key-name", className: "block text-sm font-medium text-slate-700" }, "Answer Key Name"),
                        React.createElement('input', { type: "text", id: "key-name", value: keyName, onChange: e => setKeyName(e.target.value), className: "mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500", placeholder: "e.g., Final Exam 2024" })
                    ),
                    React.createElement('div', { className: "border border-slate-200 rounded-lg p-1 bg-slate-100 flex space-x-1" },
                        React.createElement('button', { onClick: () => setMethod('manual'), className: `w-1/2 py-2 px-4 rounded-md text-sm font-medium transition-colors ${method === 'manual' ? 'bg-white shadow text-indigo-600' : 'text-slate-600 hover:bg-slate-200'}` },
                           React.createElement(Pencil, { className: "inline h-4 w-4 mr-2" }), " Manual Entry"
                        ),
                        React.createElement('button', { onClick: () => setMethod('upload'), className: `w-1/2 py-2 px-4 rounded-md text-sm font-medium transition-colors ${method === 'upload' ? 'bg-white shadow text-indigo-600' : 'text-slate-600 hover:bg-slate-200'}` },
                           React.createElement(ImageIcon, { className: "inline h-4 w-4 mr-2" }), " Upload OMR Image"
                        )
                    ),
                    method === 'manual' ? (
                        React.createElement(ManualKeyEntry, { answers: manualAnswers, setAnswers: setManualAnswers })
                    ) : (
                        React.createElement('div', null,
                            !keyImagePreview ? (
                                React.createElement('div', { className: "mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-md" },
                                    React.createElement('div', { className: "space-y-1 text-center" },
                                        React.createElement(ImageIcon, { className: "mx-auto h-12 w-12 text-slate-400" }),
                                        React.createElement('div', { className: "flex text-sm text-slate-600" }, React.createElement('label', { htmlFor: "key-file-upload", className: "relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500" }, React.createElement('span', null, "Upload a file"), React.createElement('input', { id: "key-file-upload", type: "file", className: "sr-only", onChange: handleKeyFileChange, accept: "image/*" })), React.createElement('p', { className: "pl-1" }, "of a master OMR sheet."))
                                    )
                                )
                            ) : (
                                React.createElement('div', { className: "mt-2 rounded-md overflow-hidden border border-slate-200" }, React.createElement('img', { src: keyImagePreview, alt: "Key Preview", className: "w-full h-auto" }))
                            )
                        )
                    )
                ),
                React.createElement('div', { className: "p-6 border-t bg-slate-50 rounded-b-xl flex justify-between items-center" },
                    modalError && React.createElement('p', { className: "text-sm text-red-600" }, modalError),
                    React.createElement('div', { className: "flex gap-3 ml-auto" },
                        React.createElement('button', { onClick: onClose, className: "px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md hover:bg-slate-50" }, "Cancel"),
                        React.createElement('button', { onClick: handleSave, disabled: isSaving, className: "px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 disabled:bg-indigo-400 flex items-center" },
                            isSaving && React.createElement(Loader, { className: "animate-spin h-4 w-4 mr-2" }),
                            isSaving ? 'Saving...' : 'Save Answer Key'
                        )
                    )
                )
            )
        )
    );
};

const VerifierPage = () => {
  const [imageFile, setImageFile] = useState(null);
  const [imagePreview, setImagePreview] = useState(null);
  
  const [allAnswerKeys, setAllAnswerKeys] = useState(() => getAllAnswerKeys());
  const [answerKeyId, setAnswerKeyId] = useState(Object.keys(allAnswerKeys)[0] || '');

  const [evaluationName, setEvaluationName] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState(null);
  const [result, setResult] = useState(null);
  const [isKeyModalOpen, setIsKeyModalOpen] = useState(false);

  const handleNewKeyAdded = (newKeyName) => {
    const updatedKeys = getAllAnswerKeys();
    setAllAnswerKeys(updatedKeys);
    setAnswerKeyId(newKeyName);
    addNotification({ type: 'success', message: `New answer key '${newKeyName}' added.` });
  };

  const handleFileChange = (e) => {
    const file = e.target.files?.[0];
    if (file) {
      setImageFile(file);
      const reader = new FileReader();
      reader.onloadend = () => {
        setImagePreview(reader.result);
      };
      reader.readAsDataURL(file);
      setResult(null);
      setError(null);
      setEvaluationName('');
    }
  };

  const handleEvaluate = useCallback(async () => {
    if (!imageFile) {
      setError('Please upload an OMR sheet image first.');
      return;
    }
    if (!answerKeyId || !allAnswerKeys[answerKeyId]) {
      setError('Please select a valid answer key.');
      return;
    }
    setIsLoading(true);
    setError(null);
    setResult(null);

    try {
      const detectedAnswers = await evaluateOMRWithGemini(imageFile);
      const currentAnswerKey = allAnswerKeys[answerKeyId];
      const evaluationResult = calculateScores(detectedAnswers, currentAnswerKey, imageFile.name, answerKeyId, evaluationName);
      saveResultToLocalStorage(evaluationResult);
      addNotification({ type: 'success', message: `Evaluation for '${imageFile.name}' is complete.` });
      setResult(evaluationResult);
    } catch (err) {
      console.error(err);
      setError('Failed to evaluate OMR sheet. The AI model might be unavailable or the image format is not supported. Please try again.');
    } finally {
      setIsLoading(false);
    }
  }, [imageFile, answerKeyId, evaluationName, allAnswerKeys]);
  
  const renderAnswerGrid = (answers, answerKey) => {
    return (
      React.createElement('div', { className: "grid grid-cols-5 sm:grid-cols-10 gap-2 text-sm" },
        Object.entries(answers).sort(([a], [b]) => Number(a) - Number(b)).map(([qNum, detected]) => {
          const correct = answerKey[Number(qNum)];
          const isCorrect = detected === correct;
          return (
            React.createElement('div', { key: qNum, className: `flex items-center justify-center p-2 rounded-md ${isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}` },
              React.createElement('span', { className: "font-bold mr-2" }, `${qNum}:`),
              React.createElement('span', { className: `font-mono` }, detected || '-'),
              !isCorrect && React.createElement('span', { className: "font-mono text-slate-500 ml-1" }, `(${correct})`)
            )
          )
        })
      )
    );
  };

  return (
    React.createElement('div', { className: "container mx-auto" },
      React.createElement('h1', { className: "text-3xl font-bold text-slate-800 mb-6" }, "OMR Sheet Verifier"),
      React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-8" },
        
        React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-lg" },
          React.createElement('div', { className: "space-y-6" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "file-upload", className: "block text-lg font-medium text-slate-700 mb-2" }, "Upload OMR Sheet"),
              React.createElement('div', { className: "mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-md" },
                React.createElement('div', { className: "space-y-1 text-center" },
                  React.createElement(Upload, { className: "mx-auto h-12 w-12 text-slate-400" }),
                  React.createElement('div', { className: "flex text-sm text-slate-600" },
                    React.createElement('label', { htmlFor: "file-upload", className: "relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500" },
                      React.createElement('span', null, "Upload a file"),
                      React.createElement('input', { id: "file-upload", name: "file-upload", type: "file", className: "sr-only", onChange: handleFileChange, accept: "image/*" })
                    ),
                    React.createElement('p', { className: "pl-1" }, "or drag and drop")
                  ),
                  React.createElement('p', { className: "text-xs text-slate-500" }, "PNG, JPG, GIF up to 10MB")
                )
              )
            ),
            imagePreview && (
              React.createElement('div', null,
                React.createElement('h3', { className: "text-md font-medium text-slate-700" }, "Image Preview"),
                React.createElement('div', { className: "mt-2 rounded-md overflow-hidden border border-slate-200" },
                  React.createElement('img', { src: imagePreview, alt: "OMR Preview", className: "w-full h-auto" })
                )
              )
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "answer-key", className: "block text-lg font-medium text-slate-700 mb-2" }, "Select Answer Key Version"),
              React.createElement('div', { className: "flex items-stretch gap-2" },
                React.createElement('div', { className: "relative flex-grow" },
                   React.createElement('div', { className: "pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3" },
                      React.createElement(Key, { className: "h-5 w-5 text-slate-400" })
                  ),
                  React.createElement('select', { 
                    id: "answer-key",
                    className: "block w-full pl-10 pr-3 py-2 text-base border-slate-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",
                    value: answerKeyId,
                    onChange: (e) => setAnswerKeyId(e.target.value)
                  },
                    Object.keys(allAnswerKeys).map(key => React.createElement('option', { key: key, value: key }, key))
                  )
                ),
                React.createElement('button', { onClick: () => setIsKeyModalOpen(true), className: "flex-shrink-0 flex items-center justify-center py-2 px-3 border border-indigo-600 rounded-md shadow-sm text-sm font-medium text-indigo-600 bg-white hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors", title: "Add New Answer Key" },
                    React.createElement(PlusCircle, { className: "h-5 w-5" }),
                    React.createElement('span', { className: "ml-2 hidden sm:inline" }, "New Key")
                )
              )
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "evaluation-name", className: "block text-lg font-medium text-slate-700 mb-2" }, "Evaluation Name (Optional)"),
              React.createElement('div', { className: "relative" },
                 React.createElement('div', { className: "pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3" },
                    React.createElement(FileSignature, { className: "h-5 w-5 text-slate-400" })
                ),
                React.createElement('input', {
                  id: "evaluation-name",
                  type: "text",
                  className: "block w-full pl-10 pr-3 py-2 text-base border-slate-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",
                  placeholder: "e.g., Midterm Exam - John Doe",
                  value: evaluationName,
                  onChange: (e) => setEvaluationName(e.target.value)
                })
              )
            ),
            React.createElement('button', {
              onClick: handleEvaluate,
              disabled: isLoading || !imageFile,
              className: "w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-md shadow-sm text-lg font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400 disabled:cursor-not-allowed transition-colors"
            },
              isLoading ? (React.createElement(React.Fragment, null, React.createElement(Loader, { className: "animate-spin h-5 w-5 mr-3" }), "Evaluating...")) : ('Evaluate Sheet')
            ),
            error && (React.createElement('div', { className: "flex items-center text-red-700 bg-red-100 p-3 rounded-md" }, React.createElement(XCircle, { className: "h-5 w-5 mr-2" }), React.createElement('span', null, error)))
          )
        ),
        React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-lg" },
           React.createElement('h2', { className: "text-2xl font-semibold text-slate-800 mb-4" }, "Evaluation Results"),
            result ? (
                React.createElement('div', { className: "space-y-6" },
                    React.createElement('div', { className: "bg-indigo-50 p-6 rounded-lg text-center" },
                        React.createElement('p', { className: "text-lg font-medium text-indigo-800" }, "Total Score"),
                        React.createElement('p', { className: "text-6xl font-bold text-indigo-600 mt-2" }, result.totalScore, React.createElement('span', { className: "text-3xl text-slate-500" }, "/100"))
                    ),
                    React.createElement('div', null,
                        React.createElement('h3', { className: "text-lg font-medium text-slate-700 mb-2" }, "Scores by Subject"),
                        React.createElement('div', { className: "space-y-2" },
                          Object.keys(result.subjectScores).map((subject) => {
                            const scores = result.subjectScores[subject];
                            return (
                              React.createElement('div', { key: subject, className: "flex justify-between items-center bg-slate-100 p-3 rounded-md" },
                                  React.createElement('span', { className: "font-medium text-slate-600" }, subject),
                                  React.createElement('span', { className: "font-semibold text-slate-800" }, `${scores.score} / ${scores.total}`)
                              )
                            );
                          })
                        )
                    ),
                     React.createElement('div', null,
                        React.createElement('h3', { className: "text-lg font-medium text-slate-700 mb-2" }, "Detected Answers"),
                        renderAnswerGrid(result.detectedAnswers, allAnswerKeys[result.answerKeyId])
                    )
                )
            ) : (
                React.createElement('div', { className: "flex flex-col items-center justify-center h-full text-center text-slate-500" },
                    React.createElement(FileText, { className: "h-16 w-16 mb-4" }),
                    React.createElement('p', { className: "text-lg" }, "Upload an OMR sheet and click \"Evaluate\" to see the results here.")
                )
            )
        )
      ),
      isKeyModalOpen && React.createElement(AnswerKeyModal, { onClose: () => setIsKeyModalOpen(false), onKeyAdded: handleNewKeyAdded })
    )
  );
};

// --- From pages/DashboardPage.tsx ---
const DashboardPage = () => {
    const { user } = useContext(AuthContext);
    const [results, setResults] = useState([]);

    useEffect(() => {
        setResults(getResultsFromLocalStorage());
    }, []);

    const totalEvaluations = results.length;
    const averageScore = totalEvaluations > 0 
        ? (results.reduce((sum, r) => sum + r.totalScore, 0) / totalEvaluations).toFixed(2)
        : 0;

    const subjectAverages = Object.keys(SUBJECTS).map(subjectName => {
        const totalScoreForSubject = results.reduce((sum, result) => {
            return sum + (result.subjectScores[subjectName]?.score || 0);
        }, 0);
        const subjectTotalQuestions = SUBJECTS[subjectName].end - SUBJECTS[subjectName].start + 1;
        const average = totalEvaluations > 0 ? (totalScoreForSubject / totalEvaluations) : 0;
        
        return {
            name: subjectName,
            'Average Score': parseFloat(average.toFixed(2)),
            'Total Marks': subjectTotalQuestions,
        };
    });
    
    const scoreDistribution = [
        { name: '90-100', value: results.filter(r => r.totalScore >= 90).length },
        { name: '80-89', value: results.filter(r => r.totalScore >= 80 && r.totalScore < 90).length },
        { name: '70-79', value: results.filter(r => r.totalScore >= 70 && r.totalScore < 80).length },
        { name: '60-69', value: results.filter(r => r.totalScore >= 60 && r.totalScore < 70).length },
        { name: '<60', value: results.filter(r => r.totalScore < 60).length },
    ].filter(d => d.value > 0);

    const COLORS = ['#312E81', '#4338CA', '#4F46E5', '#6366F1', '#818CF8'];
    
    return (
        React.createElement('div', { className: "space-y-8" },
            React.createElement('div', null,
                React.createElement('h1', { className: "text-3xl font-bold text-slate-800" }, `Welcome back, ${user?.name || 'Evaluator'}!`),
                React.createElement('p', { className: "text-slate-500 mt-1" }, `You have evaluated `, React.createElement('span', { className: "font-bold text-indigo-600" }, totalEvaluations), ` sheets. There are `, React.createElement('span', { className: "font-bold text-slate-700" }, "0"), ` sheets pending evaluation.`)
            ),
            
            totalEvaluations === 0 ? (
                React.createElement('div', { className: "flex items-center justify-center h-96 bg-white rounded-lg shadow-md" },
                    React.createElement('p', { className: "text-xl text-slate-500" }, "No evaluation data available. Please evaluate some OMR sheets first.")
                )
            ) : (
             React.createElement(React.Fragment, null,
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" },
                    React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md flex items-center" },
                        React.createElement('div', { className: "bg-blue-100 p-4 rounded-full mr-4" },
                            React.createElement(FileCheck2, { className: "h-8 w-8 text-blue-600" })
                        ),
                        React.createElement('div', null,
                            React.createElement('p', { className: "text-sm text-slate-500" }, "Total Evaluations"),
                            React.createElement('p', { className: "text-3xl font-bold text-slate-800" }, totalEvaluations)
                        )
                    ),
                    React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md flex items-center" },
                        React.createElement('div', { className: "bg-green-100 p-4 rounded-full mr-4" },
                            React.createElement(Star, { className: "h-8 w-8 text-green-600" })
                        ),
                        React.createElement('div', null,
                            React.createElement('p', { className: "text-sm text-slate-500" }, "Overall Average Score"),
                            React.createElement('p', { className: "text-3xl font-bold text-slate-800" }, averageScore)
                        )
                    ),
                    React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md flex items-center" },
                        React.createElement('div', { className: "bg-yellow-100 p-4 rounded-full mr-4" },
                            React.createElement(Percent, { className: "h-8 w-8 text-yellow-600" })
                        ),
                        React.createElement('div', null,
                            React.createElement('p', { className: "text-sm text-slate-500" }, "Average Percentage"),
                            React.createElement('p', { className: "text-3xl font-bold text-slate-800" }, `${averageScore}%`)
                        )
                    ),
                     React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md flex items-center" },
                        React.createElement('div', { className: "bg-orange-100 p-4 rounded-full mr-4" },
                            React.createElement(Hourglass, { className: "h-8 w-8 text-orange-600" })
                        ),
                        React.createElement('div', null,
                            React.createElement('p', { className: "text-sm text-slate-500" }, "Sheets Pending"),
                            React.createElement('p', { className: "text-3xl font-bold text-slate-800" }, "0")
                        )
                    )
                ),
                React.createElement('div', { className: "grid grid-cols-1 xl:grid-cols-5 gap-6" },
                    React.createElement('div', { className: "xl:col-span-3 bg-white p-6 rounded-lg shadow-md" },
                        React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-4" }, "Average Score by Subject"),
                        React.createElement(ResponsiveContainer, { width: "100%", height: 300 },
                            React.createElement(RechartsBarChart, { data: subjectAverages },
                                React.createElement(CartesianGrid, { strokeDasharray: "3 3" }),
                                React.createElement(XAxis, { dataKey: "name" }),
                                React.createElement(YAxis, null),
                                React.createElement(Tooltip, null),
                                React.createElement(Legend, null),
                                React.createElement(Bar, { dataKey: "Average Score", fill: "#4F46E5" })
                            )
                        )
                    ),
                    React.createElement('div', { className: "xl:col-span-2 bg-white p-6 rounded-lg shadow-md" },
                        React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-4" }, "Score Distribution"),
                        React.createElement(ResponsiveContainer, { width: "100%", height: 300 },
                            React.createElement(RechartsPieChart, null,
                                React.createElement(Pie, {
                                    data: scoreDistribution,
                                    cx: "50%",
                                    cy: "50%",
                                    labelLine: false,
                                    outerRadius: 110,
                                    fill: "#8884d8",
                                    dataKey: "value",
                                    label: ({ name, percent }) => `${name} (${(Number(percent || 0) * 100).toFixed(0)}%)`
                                },
                                    scoreDistribution.map((entry, index) => (
                                        React.createElement(Cell, { key: `cell-${index}`, fill: COLORS[index % COLORS.length] })
                                    ))
                                ),
                                React.createElement(Tooltip, null)
                            )
                        )
                    )
                )
            )
            )
        )
    );
};

// --- From pages/ResultsPage.tsx ---
const ResultsPage = () => {
    const [results, setResults] = useState([]);

    useEffect(() => {
        setResults(getResultsFromLocalStorage());
    }, []);

    const subjectHeaders = results.length > 0 ? Object.keys(results[0].subjectScores) : [];

    const handleExportCSV = () => {
        if (results.length === 0) return;

        const headers = [
            "Evaluation Date",
            "Evaluation Name",
            "File Name",
            "Answer Key",
            ...subjectHeaders,
            "Total Score"
        ];

        const csvRows = results.map(result => {
            const rowData = [
                `"${new Date(result.evaluationDate).toLocaleString()}"`,
                `"${result.evaluationName || ''}"`,
                `"${result.imageFileName}"`,
                `"${result.answerKeyId}"`
            ];

            subjectHeaders.forEach(subject => {
                const scoreInfo = result.subjectScores[subject];
                rowData.push(scoreInfo ? `"${scoreInfo.score}/${scoreInfo.total}"` : '"N/A"');
            });
            
            rowData.push(`"${result.totalScore}/100"`);

            return rowData.join(',');
        });

        const csvString = [headers.join(','), ...csvRows].join('\n');
        const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'evalify_results.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };

    return (
        React.createElement('div', null,
            React.createElement('div', { className: "flex justify-between items-center mb-6" },
                React.createElement('h1', { className: "text-3xl font-bold text-slate-800" }, "All Evaluation Results"),
                React.createElement('button', {
                    onClick: handleExportCSV,
                    disabled: results.length === 0,
                    className: "flex items-center justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400 disabled:cursor-not-allowed transition-colors"
                },
                    React.createElement(Download, { className: "h-4 w-4 mr-2" }),
                    "Export CSV"
                )
            ),
            React.createElement('div', { className: "bg-white shadow-md rounded-lg overflow-hidden" },
                React.createElement('div', { className: "overflow-x-auto" },
                    React.createElement('table', { className: "min-w-full leading-normal" },
                        React.createElement('thead', null,
                            React.createElement('tr', { className: "border-b-2 border-slate-200 bg-indigo-50 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" },
                                React.createElement('th', { className: "px-5 py-3" }, "Evaluation Date"),
                                React.createElement('th', { className: "px-5 py-3" }, "Evaluation Name"),
                                React.createElement('th', { className: "px-5 py-3" }, "File Name"),
                                React.createElement('th', { className: "px-5 py-3" }, "Answer Key"),
                                subjectHeaders.map(subject => (
                                  React.createElement('th', { key: subject, className: "px-5 py-3 text-center" }, subject)
                                )),
                                React.createElement('th', { className: "px-5 py-3 text-right" }, "Total Score")
                            )
                        ),
                        React.createElement('tbody', null,
                            results.length > 0 ? results.map((result, index) => (
                                React.createElement('tr', { key: result.id, className: `border-b border-slate-200 ${index % 2 === 0 ? 'bg-white' : 'bg-slate-50/50'} hover:bg-indigo-50/70` },
                                    React.createElement('td', { className: "px-5 py-4 text-sm text-slate-700" },
                                        new Date(result.evaluationDate).toLocaleString()
                                    ),
                                    React.createElement('td', { className: "px-5 py-4 text-sm text-slate-700 font-medium" },
                                        result.evaluationName || '--'
                                    ),
                                    React.createElement('td', { className: "px-5 py-4 text-sm text-slate-700 truncate max-w-xs" },
                                        result.imageFileName
                                    ),
                                    React.createElement('td', { className: "px-5 py-4 text-sm" },
                                        React.createElement('span', { className: "bg-slate-200 text-slate-700 py-1 px-3 rounded-full text-xs font-medium" },
                                            result.answerKeyId
                                        )
                                    ),
                                    subjectHeaders.map((subject) => (
                                      React.createElement('td', { key: subject, className: "px-5 py-4 text-sm text-center text-slate-700" },
                                        result.subjectScores[subject] ? `${result.subjectScores[subject].score}/${result.subjectScores[subject].total}` : 'N/A'
                                      )
                                    )),
                                    React.createElement('td', { className: "px-5 py-4 text-sm text-right" },
                                        React.createElement('span', { className: `font-semibold ${result.totalScore > 75 ? 'text-green-600' : result.totalScore > 50 ? 'text-yellow-600' : 'text-red-600'}` },
                                            `${result.totalScore} / 100`
                                        )
                                    )
                                )
                            )) : (
                                React.createElement('tr', null,
                                    React.createElement('td', { colSpan: 5 + subjectHeaders.length, className: "text-center py-10 text-slate-500" },
                                        "No results found."
                                    )
                                )
                            )
                        )
                    )
                )
            )
        )
    );
};

// --- From pages/AnalyticsPage.tsx ---
const AnalyticsPage = () => {
    const [results, setResults] = useState([]);

    useEffect(() => {
        setResults(getResultsFromLocalStorage());
    }, []);

    const analyticsData = useMemo(() => {
        if (results.length === 0) {
            return null;
        }

        const scoreBins = {
            '0-10': 0, '11-20': 0, '21-30': 0, '31-40': 0, '41-50': 0,
            '51-60': 0, '61-70': 0, '71-80': 0, '81-90': 0, '91-100': 0,
        };
        results.forEach(r => {
            if (r.totalScore > 90) scoreBins['91-100']++;
            else if (r.totalScore > 80) scoreBins['81-90']++;
            else if (r.totalScore > 70) scoreBins['71-80']++;
            else if (r.totalScore > 60) scoreBins['61-70']++;
            else if (r.totalScore > 50) scoreBins['51-60']++;
            else if (r.totalScore > 40) scoreBins['41-50']++;
            else if (r.totalScore > 30) scoreBins['31-40']++;
            else if (r.totalScore > 20) scoreBins['21-30']++;
            else if (r.totalScore > 10) scoreBins['11-20']++;
            else scoreBins['0-10']++;
        });
        const scoreDistribution = Object.entries(scoreBins).map(([name, count]) => ({ name, count }));

        const subjectPerformance = Object.keys(SUBJECTS).map(subjectName => {
            const totalScoreForSubject = results.reduce((sum, result) => sum + (result.subjectScores[subjectName]?.score || 0), 0);
            const subjectTotalQuestions = SUBJECTS[subjectName].end - SUBJECTS[subjectName].start + 1;
            const totalPossible = results.length * subjectTotalQuestions;
            const percentage = totalPossible > 0 ? parseFloat(((totalScoreForSubject / totalPossible) * 100).toFixed(2)) : 0;
            return {
                subject: subjectName,
                'Performance (%)': percentage,
                fullMark: 100,
            };
        });

        const evaluationTrend = [...results]
            .sort((a, b) => new Date(a.evaluationDate).getTime() - new Date(b.evaluationDate).getTime())
            .map((r, index) => ({
                name: `Eval #${index + 1}`,
                score: r.totalScore,
                date: new Date(r.evaluationDate).toLocaleDateString(),
            }));
            
        return { scoreDistribution, subjectPerformance, evaluationTrend };
    }, [results]);

    if (results.length === 0) {
        return (
             React.createElement('div', { className: "space-y-8" },
                React.createElement('h1', { className: "text-3xl font-bold text-slate-800" }, "Evaluation Analytics"),
                React.createElement('div', { className: "flex items-center justify-center h-96 bg-white rounded-lg shadow-md" },
                    React.createElement('p', { className: "text-xl text-slate-500" }, "No analytics to display. Evaluate some sheets to get started.")
                )
            )
        )
    }

    return (
        React.createElement('div', { className: "space-y-8" },
            React.createElement('h1', { className: "text-3xl font-bold text-slate-800" }, "Evaluation Analytics"),
            React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-8" },
                React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
                    React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-4" }, "Score Distribution"),
                    React.createElement(ResponsiveContainer, { width: "100%", height: 300 },
                        React.createElement(RechartsBarChart, { data: analyticsData?.scoreDistribution, margin: { top: 5, right: 20, left: -10, bottom: 5 } },
                            React.createElement(CartesianGrid, { strokeDasharray: "3 3" }),
                            React.createElement(XAxis, { dataKey: "name" }),
                            React.createElement(YAxis, { allowDecimals: false }),
                            React.createElement(Tooltip, null),
                            React.createElement(Legend, null),
                            React.createElement(Bar, { dataKey: "count", name: "Number of Students", fill: "#4F46E5" })
                        )
                    )
                ),
                React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
                    React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-4" }, "Subject Performance"),
                    React.createElement(ResponsiveContainer, { width: "100%", height: 300 },
                        React.createElement(RadarChart, { cx: "50%", cy: "50%", outerRadius: "80%", data: analyticsData?.subjectPerformance },
                            React.createElement(PolarGrid, null),
                            React.createElement(PolarAngleAxis, { dataKey: "subject" }),
                            React.createElement(PolarRadiusAxis, { angle: 30, domain: [0, 100] }),
                            React.createElement(Radar, { name: "Performance", dataKey: "Performance (%)", stroke: "#4F46E5", fill: "#4F46E5", fillOpacity: 0.6 }),
                            React.createElement(Tooltip, null),
                            React.createElement(Legend, null)
                        )
                    )
                )
            ),
            React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
                React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-4" }, "Evaluation Trend Over Time"),
                React.createElement(ResponsiveContainer, { width: "100%", height: 300 },
                    React.createElement(LineChart, { data: analyticsData?.evaluationTrend, margin: { top: 5, right: 20, left: -10, bottom: 5 } },
                        React.createElement(CartesianGrid, { strokeDasharray: "3 3" }),
                        React.createElement(XAxis, { dataKey: "name" }),
                        React.createElement(YAxis, null),
                        React.createElement(Tooltip, { contentStyle: { backgroundColor: '#f3f4f6' }, labelFormatter: (value, payload) => payload[0]?.payload.date || value }),
                        React.createElement(Legend, null),
                        React.createElement(Line, { type: "monotone", dataKey: "score", stroke: "#4F46E5", strokeWidth: 2, activeDot: { r: 8 } })
                    )
                )
            )
        )
    );
};

// --- From pages/HelpPage.tsx ---
const FAQItem = ({ question, children }) => (
  React.createElement('details', { className: "group border-b border-slate-200 py-4" },
    React.createElement('summary', { className: "flex items-center justify-between font-medium text-slate-800 cursor-pointer list-none" },
      React.createElement('span', null, question),
      React.createElement('span', { className: "transition-transform duration-300 group-open:rotate-180" },
        React.createElement('svg', { fill: "none", height: "24", shapeRendering: "geometricPrecision", stroke: "currentColor", strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: "1.5", viewBox: "0 0 24 24", width: "24" }, React.createElement('path', { d: "M6 9l6 6 6-6" }))
      )
    ),
    React.createElement('div', { className: "text-slate-600 mt-3 prose prose-sm max-w-none" },
      children
    )
  )
);

const HelpPage = () => {
  return (
    React.createElement('div', { className: "space-y-8" },
      React.createElement('div', null,
          React.createElement('h1', { className: "text-3xl font-bold text-slate-800 mb-2" }, "Help & FAQ"),
          React.createElement('p', { className: "text-slate-500" }, "Find answers to common questions about using Evalify.")
      ),
      
      React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
        React.createElement('div', { className: "space-y-4" },
            React.createElement('h2', { className: "text-xl font-semibold text-slate-700 flex items-center" }, React.createElement(HelpCircle, { className: "mr-2 text-indigo-600" }), "Getting Started"),
            React.createElement(FAQItem, { question: "How do I log into the application?" },
              React.createElement('p', null, "To get started, use the default credentials provided on the login page:"),
              React.createElement('ul', null,
                React.createElement('li', null, React.createElement('strong', null, "Email:"), " ", React.createElement('code', null, "evaluator@innomatics.com")),
                React.createElement('li', null, React.createElement('strong', null, "Password:"), " ", React.createElement('code', null, "password123"))
              ),
              React.createElement('p', null, "You can also update your name on the Dashboard page to personalize your experience.")
            ),
            React.createElement('h2', { className: "text-xl font-semibold text-slate-700 flex items-center pt-4" }, React.createElement(Upload, { className: "mr-2 text-indigo-600" }), "Uploading & Evaluating"),
            React.createElement(FAQItem, { question: "How do I evaluate an OMR sheet?" },
              React.createElement('p', null, "Follow these simple steps on the ", React.createElement('strong', null, "OMR Verifier"), " page:"),
              React.createElement('ol', null,
                React.createElement('li', null, "Click the \"Upload a file\" button or drag and drop an image of your OMR sheet into the designated area."),
                React.createElement('li', null, "Ensure the correct answer key version is selected from the dropdown menu (e.g., 'Version A')."),
                React.createElement('li', null, "Click the \"Evaluate Sheet\" button."),
                React.createElement('li', null, "The results, including total score, subject scores, and a detailed answer grid, will appear on the right side of the screen.")
              )
            ),
            React.createElement(FAQItem, { question: "What are the best practices for OMR sheet images?" },
              React.createElement('p', null, "For the most accurate results, please ensure your image is:"),
              React.createElement('ul', null,
                React.createElement('li', null, React.createElement('strong', null, "Clear and in focus:"), " Avoid blurry images."),
                React.createElement('li', null, React.createElement('strong', null, "Well-lit:"), " Make sure there are no strong shadows or glare covering the bubbles."),
                React.createElement('li', null, React.createElement('strong', null, "Properly aligned:"), " The sheet should be flat and not photographed at a sharp angle."),
                React.createElement('li', null, React.createElement('strong', null, "High-resolution:"), " A higher quality image allows the AI to better detect the marked bubbles.")
              )
            ),
             React.createElement('h2', { className: "text-xl font-semibold text-slate-700 flex items-center pt-4" }, React.createElement(BarChart3, { className: "mr-2 text-indigo-600" }), "Understanding Results"),
            React.createElement(FAQItem, { question: "How do I interpret the detected answers grid?" },
               React.createElement('p', null, "The grid on the ", React.createElement('strong', null, "OMR Verifier"), " page gives you a question-by-question breakdown:"),
              React.createElement('ul', null,
                React.createElement('li', null, React.createElement('span', { className: "font-semibold text-green-600" }, "Green background:"), " Indicates a correct answer."),
                React.createElement('li', null, React.createElement('span', { className: "font-semibold text-red-600" }, "Red background:"), " Indicates an incorrect answer. The correct answer is shown in parentheses, e.g., ", React.createElement('code', { className: "text-slate-500" }, "(A)"), "."),
                 React.createElement('li', null, "A hyphen ", React.createElement('code', { className: "font-mono" }, "-"), " indicates the question was left blank.")
              )
            ),
             React.createElement(FAQItem, { question: "Where can I see all past evaluations?" },
              React.createElement('p', null, "All completed evaluations are stored and can be viewed on the ", React.createElement('strong', null, "Results"), " page. The table provides a summary of each evaluation, including the date, filename, answer key used, and total score.")
            ),
            React.createElement('h2', { className: "text-xl font-semibold text-slate-700 flex items-center pt-4" }, React.createElement(AlertTriangle, { className: "mr-2 text-indigo-600" }), "Troubleshooting"),
            React.createElement(FAQItem, { question: "Why did the evaluation fail or give an error?" },
                React.createElement('p', null, "An evaluation can fail for a few reasons:"),
                React.createElement('ul', null,
                    React.createElement('li', null, React.createElement('strong', null, "Poor Image Quality:"), " This is the most common cause. If the image is blurry, skewed, or poorly lit, the AI may not be able to process it. Please try taking another picture."),
                    React.createElement('li', null, React.createElement('strong', null, "Unsupported Format:"), " Ensure you are uploading a standard image file (like PNG, JPG, or GIF)."),
                    React.createElement('li', null, React.createElement('strong', null, "AI Model Issue:"), " On rare occasions, the AI service may be temporarily unavailable. Please wait a moment and try again.")
                )
            ),
             React.createElement(FAQItem, { question: "Why is the Dashboard or Analytics page empty?" },
                React.createElement('p', null, "The ", React.createElement('strong', null, "Dashboard"), " and ", React.createElement('strong', null, "Analytics"), " pages generate charts and statistics based on your evaluation history. If you haven't evaluated any OMR sheets yet, these pages will be empty. Once you evaluate your first sheet, the data will appear automatically.")
            )
        )
      )
    )
  );
};

// --- From pages/ProfilePage.tsx ---
const ProfilePage = () => {
    const { user, updateUser } = useContext(AuthContext);

    const [name, setName] = useState(user?.name || '');
    const [phone, setPhone] = useState(user?.phone || '');
    const [profilePicture, setProfilePicture] = useState(user?.profilePicture || null);
    const [infoSuccessMessage, setInfoSuccessMessage] = useState('');

    const [currentPassword, setCurrentPassword] = useState('');
    const [newPassword, setNewPassword] = useState('');
    const [confirmPassword, setConfirmPassword] = useState('');
    const [passwordError, setPasswordError] = useState('');
    const [passwordSuccessMessage, setPasswordSuccessMessage] = useState('');

    if (!user) {
        return React.createElement('div', null, "Loading user profile...");
    }

    const handleImageChange = (e) => {
        if (e.target.files && e.target.files[0]) {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onloadend = () => {
                setProfilePicture(reader.result);
            };
            reader.readAsDataURL(file);
        }
    };

    const handleInfoSubmit = (e) => {
        e.preventDefault();
        const updatedData = { name, phone };
        if (profilePicture) {
            updatedData.profilePicture = profilePicture;
        }
        updateUser(updatedData);
        setInfoSuccessMessage('Profile updated successfully!');
        setTimeout(() => setInfoSuccessMessage(''), 3000);
    };

    const handlePasswordChange = (e) => {
        e.preventDefault();
        setPasswordError('');
        setPasswordSuccessMessage('');

        if (newPassword !== confirmPassword) {
            setPasswordError("New passwords do not match.");
            return;
        }
        if (!newPassword || newPassword.length < 8) {
            setPasswordError("New password must be at least 8 characters long.");
            return;
        }
        if (currentPassword !== 'password123') {
            setPasswordError("Your old password is not correct.");
            return;
        }

        setPasswordSuccessMessage("Password changed successfully!");
        setCurrentPassword('');
        setNewPassword('');
        setConfirmPassword('');
        setTimeout(() => setPasswordSuccessMessage(''), 4000);
    };

    return (
        React.createElement('div', { className: "max-w-4xl mx-auto" },
            React.createElement('h1', { className: "text-3xl font-bold text-slate-800 mb-8" }, "Profile Settings"),
            React.createElement('form', { onSubmit: handleInfoSubmit, className: "bg-white p-8 rounded-lg shadow-lg mb-8" },
                React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-6" }, "Personal Information"),
                React.createElement('div', { className: "flex items-center space-x-6 mb-8" },
                    React.createElement('div', { className: "relative" },
                        React.createElement('img', { 
                            src: profilePicture || `https://ui-avatars.com/api/?name=${name || 'E'}&background=c7d2fe&color=4338ca&size=128`, 
                            alt: "Profile", 
                            className: "w-24 h-24 rounded-full object-cover" 
                        }),
                        React.createElement('label', { htmlFor: "profile-picture-upload", className: "absolute -bottom-2 -right-2 bg-indigo-600 text-white p-2 rounded-full cursor-pointer hover:bg-indigo-700 transition-colors" },
                            React.createElement(Camera, { className: "w-5 h-5" }),
                            React.createElement('input', { id: "profile-picture-upload", type: "file", className: "sr-only", accept: "image/*", onChange: handleImageChange })
                        )
                    ),
                    React.createElement('div', null,
                         React.createElement('h3', { className: "text-2xl font-bold text-slate-800" }, name || 'Evaluator'),
                         React.createElement('p', { className: "text-slate-500" }, user.email)
                    )
                ),
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-6" },
                    React.createElement('div', null,
                        React.createElement('label', { htmlFor: "full-name", className: "block text-sm font-medium text-slate-700" }, "Full Name"),
                         React.createElement('div', { className: "relative mt-1" },
                            React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                React.createElement(UserIcon, { className: "h-5 w-5 text-slate-400" })
                            ),
                            React.createElement('input', { type: "text", id: "full-name", value: name, onChange: e => setName(e.target.value), className: "block w-full pl-10 pr-3 py-2 border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500", placeholder: "Your Name" })
                        )
                    ),
                    React.createElement('div', null,
                        React.createElement('label', { htmlFor: "email", className: "block text-sm font-medium text-slate-700" }, "Email Address"),
                         React.createElement('div', { className: "relative mt-1" },
                            React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                React.createElement(AtSign, { className: "h-5 w-5 text-slate-400" })
                            ),
                            React.createElement('input', { type: "email", id: "email", value: user.email, disabled: true, className: "block w-full pl-10 pr-3 py-2 border-slate-300 rounded-md bg-slate-100 cursor-not-allowed" })
                        )
                    ),
                     React.createElement('div', null,
                        React.createElement('label', { htmlFor: "phone-number", className: "block text-sm font-medium text-slate-700" }, "Phone Number"),
                         React.createElement('div', { className: "relative mt-1" },
                            React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                React.createElement(Phone, { className: "h-5 w-5 text-slate-400" })
                            ),
                            React.createElement('input', { type: "tel", id: "phone-number", value: phone, onChange: e => setPhone(e.target.value), className: "block w-full pl-10 pr-3 py-2 border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500", placeholder: "e.g., +1 234 567 890" })
                        )
                    )
                ),
                React.createElement('div', { className: "flex justify-end items-center space-x-4 mt-8" },
                    infoSuccessMessage && React.createElement('p', { className: "text-sm text-green-600" }, infoSuccessMessage),
                    React.createElement('button', {
                        type: "submit",
                        className: "flex items-center justify-center py-2 px-6 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"
                    },
                        React.createElement(Save, { className: "h-4 w-4 mr-2" }),
                        "Save Changes"
                    )
                )
            ),
            React.createElement('form', { onSubmit: handlePasswordChange, className: "bg-white p-8 rounded-lg shadow-lg" },
                 React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-6" }, "Change Password"),
                 React.createElement('div', { className: "space-y-4" },
                    React.createElement('div', null,
                        React.createElement('label', { htmlFor: "current-password", className: "block text-sm font-medium text-slate-700" }, "Old Password"),
                         React.createElement('div', { className: "relative mt-1" },
                            React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                React.createElement(Lock, { className: "h-5 w-5 text-slate-400" })
                            ),
                            React.createElement('input', { type: "password", id: "current-password", value: currentPassword, onChange: e => setCurrentPassword(e.target.value), required: true, className: "block w-full pl-10 pr-3 py-2 border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500", placeholder: "Enter your old password" })
                        )
                    ),
                     React.createElement('div', null,
                        React.createElement('label', { htmlFor: "new-password", className: "block text-sm font-medium text-slate-700" }, "New Password"),
                         React.createElement('div', { className: "relative mt-1" },
                            React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                React.createElement(Lock, { className: "h-5 w-5 text-slate-400" })
                            ),
                            React.createElement('input', { type: "password", id: "new-password", value: newPassword, onChange: e => setNewPassword(e.target.value), required: true, className: "block w-full pl-10 pr-3 py-2 border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500", placeholder: "Enter your new password" })
                        )
                    ),
                    React.createElement('div', null,
                        React.createElement('label', { htmlFor: "confirm-password", className: "block text-sm font-medium text-slate-700" }, "Confirm New Password"),
                         React.createElement('div', { className: "relative mt-1" },
                            React.createElement('div', { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" },
                                React.createElement(Lock, { className: "h-5 w-5 text-slate-400" })
                            ),
                            React.createElement('input', { type: "password", id: "confirm-password", value: confirmPassword, onChange: e => setConfirmPassword(e.target.value), required: true, className: "block w-full pl-10 pr-3 py-2 border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500", placeholder: "Confirm your new password" })
                        )
                    )
                 ),
                 React.createElement('div', { className: "flex justify-end items-center space-x-4 mt-8" },
                    passwordError && React.createElement('p', { className: "text-sm text-red-600" }, passwordError),
                    passwordSuccessMessage && (
                        React.createElement('div', { className: "text-sm text-green-600 flex items-center" },
                            React.createElement(CheckCircle, { className: "h-4 w-4 mr-1" }), 
                            React.createElement('div', null,
                                passwordSuccessMessage,
                                React.createElement('p', { className: "text-xs text-slate-500 italic" }, "(Demo only: login password remains 'password123')")
                            )
                        )
                    ),
                    React.createElement('button', {
                        type: "submit",
                        className: "flex items-center justify-center py-2 px-6 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-colors"
                    },
                        "Change Password"
                    )
                )
            )
        )
    );
};

// --- From pages/NotificationsPage.tsx ---
const NotificationsPage = () => {
    const [notifications, setNotifications] = useState([]);

    useEffect(() => {
        setNotifications(getNotifications());
    }, []);

    const timeSince = (dateString) => {
        const date = new Date(dateString);
        const seconds = Math.floor((new Date().getTime() - date.getTime()) / 1000);
        let interval = seconds / 31536000;
        if (interval > 1) return `${Math.floor(interval)} years ago`;
        interval = seconds / 2592000;
        if (interval > 1) return `${Math.floor(interval)} months ago`;
        interval = seconds / 86400;
        if (interval > 1) return `${Math.floor(interval)} days ago`;
        interval = seconds / 3600;
        if (interval > 1) return `${Math.floor(interval)} hours ago`;
        interval = seconds / 60;
        if (interval > 1) return `${Math.floor(interval)} minutes ago`;
        return `${Math.floor(seconds)} seconds ago`;
    };

    const handleMarkAllRead = () => {
        markAllNotificationsAsRead();
        setNotifications(getNotifications());
    };
    
    const unreadCount = notifications.filter(n => !n.read).length;

    return (
        React.createElement('div', { className: "max-w-4xl mx-auto" },
            React.createElement('div', { className: "flex justify-between items-center mb-6" },
                React.createElement('h1', { className: "text-3xl font-bold text-slate-800" }, "Notifications"),
                React.createElement('button', {
                    onClick: handleMarkAllRead,
                    disabled: unreadCount === 0,
                    className: "flex items-center justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400 disabled:cursor-not-allowed transition-colors"
                },
                    React.createElement(Check, { className: "h-4 w-4 mr-2" }),
                    "Mark all as read"
                )
            ),
            React.createElement('div', { className: "bg-white shadow-md rounded-lg overflow-hidden" },
                React.createElement('div', { className: "p-4 space-y-3" },
                    notifications.length > 0 ? (
                        notifications.map(notification => (
                            React.createElement('div', { key: notification.id, className: `flex items-start p-4 rounded-lg transition-colors ${notification.read ? 'bg-slate-50' : 'bg-indigo-50'}` },
                                React.createElement('div', { className: `relative p-2 rounded-full mr-4 mt-1 ${notification.type === 'success' ? 'bg-green-100' : 'bg-blue-100'}` },
                                    notification.type === 'success' ? (
                                        React.createElement(CheckCircle, { className: "h-5 w-5 text-green-600" })
                                    ) : (
                                        React.createElement(Info, { className: "h-5 w-5 text-blue-600" })
                                    ),
                                     !notification.read && React.createElement('span', { className: "absolute -top-1 -right-1 block h-3 w-3 rounded-full bg-indigo-500 ring-2 ring-indigo-50" })
                                ),
                                React.createElement('div', { className: "flex-1" },
                                    React.createElement('p', { className: `font-medium ${notification.read ? 'text-slate-600' : 'text-slate-800'}` }, notification.message),
                                    React.createElement('p', { className: "text-sm text-slate-500" }, timeSince(notification.timestamp))
                                )
                            )
                        ))
                    ) : (
                        React.createElement('div', { className: "flex flex-col items-center justify-center text-center text-slate-500 py-16" },
                            React.createElement(Bell, { className: "h-16 w-16 mb-4 text-slate-300" }),
                            React.createElement('h3', { className: "text-xl font-semibold" }, "No Notifications Yet"),
                            React.createElement('p', null, "New notifications about your evaluations will appear here.")
                        )
                    )
                )
            )
        )
    );
};


// --- From App.tsx ---
function App() {
  const [user, setUser] = useState(() => {
    const storedUser = localStorage.getItem('evalify_user');
    try {
      return storedUser ? JSON.parse(storedUser) : null;
    } catch (error) {
      return null;
    }
  });

  const login = useCallback((userData) => {
    localStorage.setItem('evalify_user', JSON.stringify(userData));
    addNotification({ type: 'info', message: 'Login successful. Welcome back!' });
    setUser(userData);
  }, []);

  const logout = useCallback(() => {
    localStorage.removeItem('evalify_user');
    setUser(null);
  }, []);

  const updateUser = useCallback((updatedData) => {
    setUser(currentUser => {
      if (currentUser) {
        const newUser = { ...currentUser, ...updatedData };
        localStorage.setItem('evalify_user', JSON.stringify(newUser));
        return newUser;
      }
      return null;
    });
  }, []);

  const authContextValue = useMemo(() => ({ user, login, logout, updateUser }), [user, login, logout, updateUser]);

  return (
    React.createElement(AuthContext.Provider, { value: authContextValue },
      React.createElement(HashRouter, null,
        React.createElement(Routes, null,
          React.createElement(Route, { path: "/login", element: user ? React.createElement(Navigate, { to: "/" }) : React.createElement(LoginPage, null) }),
          React.createElement(Route, { 
            path: "/*",
            element:
              user ? (
                React.createElement(MainLayout, null,
                  React.createElement(Routes, null,
                    React.createElement(Route, { path: "/", element: React.createElement(VerifierPage, null) }),
                    React.createElement(Route, { path: "/dashboard", element: React.createElement(DashboardPage, null) }),
                    React.createElement(Route, { path: "/results", element: React.createElement(ResultsPage, null) }),
                    React.createElement(Route, { path: "/analytics", element: React.createElement(AnalyticsPage, null) }),
                    React.createElement(Route, { path: "/notifications", element: React.createElement(NotificationsPage, null) }),
                    React.createElement(Route, { path: "/help", element: React.createElement(HelpPage, null) }),
                    React.createElement(Route, { path: "/profile", element: React.createElement(ProfilePage, null) }),
                    React.createElement(Route, { path: "*", element: React.createElement(Navigate, { to: "/" }) })
                  )
                )
              ) : (
                React.createElement(Navigate, { to: "/login" })
              )
          })
        )
      )
    )
  );
}

// --- From index.tsx ---
const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}

const root = ReactDOM.createRoot(rootElement);
root.render(
  React.createElement(React.StrictMode, null,
    React.createElement(App, null)
  )
);
    </script>
  </body>
</html>
